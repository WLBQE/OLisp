(class grade
  (member (double total))
  (member (double plt))
  (constructor total plt))

(define ((grade -> (grade -> bool)) grade_less_than)
  (lambda (grade -> (grade -> bool)) (g2)
    (lambda (grade -> bool) (g1)
      (if (= g1.total g2.total)
        (< g1.plt g2.plt)
        (< g1.total g2.total)))))

(define (([grade] (grade -> bool) -> [grade]) filter)
  (lambda ([grade] (grade -> bool) -> [grade]) (lst cond)
    (if (empty lst)
      (list grade)
      (if (cond (car lst))
        (cons (car lst) (filter (cdr lst) cond))
        (filter (cdr lst) cond)))))

(define (([grade] -> [grade]) qsort)
  (lambda ([grade] -> [grade]) (lst)
    (if (empty lst)
      (list grade)
      (append (qsort (filter lst (grade_less_than (car lst))))
        (list grade (car lst))
        (qsort (filter lst (lambda (grade -> bool) (elem)
          (not ((grade_less_than (car lst)) elem)))))))))

(define (grade Alice) (grade 3.8 4.0))
(define (grade Bob) (grade 3.2 2.67))
(define (grade Carol) (grade 3.8 3.67))
(define (grade Jiaqi) (grade 4.33 4.33))

(define ([grade] sorted) (qsort (list grade Alice Bob Carol Jiaqi)))
